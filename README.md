# SecurityServiceBox

<aside> ğŸ’¡ ä¸€ä¸ªWindowså¹³å°ä¸‹æ—¢å¯ä»¥æ»¡è¶³å®‰æœä»”æ—¥å¸¸æ¸—é€å·¥ä½œä¹Ÿå¯ä»¥æ‰¹é‡åˆ·æ´çš„å·¥å…·ç›’å­ã€‚
å¤§ä½¬è½»å–·

## 0x01 å‰è¨€

ä½œä¸ºä¸€ä¸ªå®‰æœä»”ï¼Œæ—¥å¸¸æ¸—é€ä¸­ï¼Œä¸åŒé˜¶æ®µæ‰€ä½¿ç”¨çš„å·¥å…·æ˜¯ä¸åŒçš„ï¼Œé™¤å¼€è‡ªåŠ¨åŒ–ä¸€æ¡é¾™çš„è„šæœ¬ä¹‹å¤–ï¼Œå¾ˆå¤šæ—¶å€™æ˜¯éœ€è¦åå¤çš„è¿›å…¥ä¸åŒçš„æ–‡ä»¶å¤¹è¿è¡Œä¸åŒçš„å‘½ä»¤ï¼Œæ¯æ¬¡ä½¿ç”¨å·¥å…·çš„æ—¶å€™å‘½ä»¤å¯èƒ½ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆæ˜¯å¦æœ‰ç§æ–¹å¼å°†å¸¸ç”¨çš„å·¥å…·ï¼Œå¸¸ç”¨çš„å‘½ä»¤é›†æˆåœ¨ä¸€èµ·ï¼Œæ¸—é€çš„æ—¶å€™ä»…éœ€ç»™å®šç›®æ ‡ï¼Œå°±å¯ä»¥è°ƒç”¨å·¥å…·è‡ªåŠ¨æ‰§è¡Œå‘½ä»¤ã€‚ä¹‹å‰æµè¡Œè¿‡çš„`GUI_Tools`æ˜¯ä¸€ä¸ªï¼Œæœ‰äº†å›¾å½¢åŒ–é¡µé¢ï¼Œç‚¹å‡»å³å¯è¿è¡Œï¼Œä½†æ˜¯ä¸€ä¸ªæ˜¯åœ¨Windowsç¯å¢ƒä¸‹ç•Œé¢å®åœ¨ä¸æ•¢æ­ç»´ï¼Œä¸€ä¸ªæ˜¯æ— æ³•æ›´å¥½çš„äº¤äº’ï¼ˆæˆ–è€…ä¹Ÿè®¸æˆ‘æ²¡æ‰¾åˆ°äº¤äº’çš„æ–¹å¼ï¼‰ã€‚åæ¥æ— æ„é—´å‘ç°äº†é˜¿æµªå¸ˆå‚…å†™çš„ä¸€ä¸ªè‡ªç”¨çš„å‘½ä»¤è¡Œè°ƒç”¨å·¥å…·ï¼Œä¹Ÿå°±æ˜¯Wanliçš„åˆå§‹ç‰ˆæœ¬ã€‚æœ€å¼€å§‹ä¹Ÿåœ¨å…¬ä¼—å·æ–‡ç« è¯´è¿‡ï¼Œæœ€åˆçš„è®¾å®šæ˜¯â€œæŠŠå¸¸ç”¨çš„å·¥å…·ç»™åšäº†ä¸€ä¸ªè°ƒç”¨æ•´åˆåˆ°ä¸€ä¸ªç¨‹åºå†…ï¼ŒåŠŸèƒ½æ‹“å±•æ¯”è¾ƒæ–¹ä¾¿ï¼Œç›®å‰æ˜¯æ ¹æ®è‡ªå·±çš„ä¸€äº›ä¹ æƒ¯å†™çš„ï¼Œæ¯”å¦‚ç›®å½•æ‰«æã€å­åŸŸåçˆ†ç ´+éªŒè¯ã€æ¼æ´æ‰«æâ€ã€‚å°±ç›¸å½“äºä¸€ä¸ªå¿«æ·å¯åŠ¨å·¥å…·ï¼Œä¸GUI_Toolsä¸åŒçš„æ˜¯ï¼ŒWanliå¯ä»¥æ›´å¥½çš„äº¤äº’ï¼Œæ‰§è¡Œè‡ªå®šä¹‰çš„å‘½ä»¤ã€‚å½“ç„¶ï¼Œå¹¶æ— æ¯”è¾ƒçš„æ„æ€ï¼Œä¸¤ä¸ªå¸ˆå‚…çš„å·¥å…·éƒ½æœ‰åœ¨ç”¨ï¼ˆæ‰‹åŠ¨ç‹—å¤´ :ï¼‰ã€‚

Wanliçš„é¡¹ç›®åœ°å€ï¼šhttps://github.com/ExpLangcn/WanLiâ€£

ä¸æœ€åˆçš„ç‰ˆæœ¬ä¸åŒï¼Œæœ€æ–°çš„Wanliå®šä½å‘ç”Ÿäº†å˜åŒ–ï¼Œç”±è‡ªç”¨çš„è°ƒåº¦å·¥å…·å˜ä¸ºäº†åå‘çº¢é˜Ÿçš„æ”¶é›†æ¼æ‰«ä¸€ä½“åŒ–å·¥å…·ï¼Œæ•ˆæœåŒæ ·é¡¶å‘±å‘±ã€‚æœ¬ç¯‡æ–‡ç« ä¾æ®Wanliçš„åˆå§‹ç‰ˆæœ¬ã€‚

## 0x02 è¿è¡Œæˆªå›¾

è¿è¡Œä¸»ç•Œé¢ï¼š

![Untitled](./pics/main.png)

åŸºäºWinç¯å¢ƒä¸‹è¿è¡Œ`cmd /k` å³å¯æ–°å¼€cmdçª—å£ï¼Œé™¤`collect_subdomain`ä¹‹å¤–ï¼Œå…¶ä½™å·¥å…·å‡å¯æ— éœ€ç­‰å¾…å½“å‰å‘½ä»¤æ‰§è¡Œç»“æŸç›´æ¥æ‰§è¡Œä¸‹ä¸€æ¡å‘½ä»¤ã€‚ä¸”æ”¯æŒTABé”®å…³é”®å­—è‡ªåŠ¨è¡¥å…¨ã€‚

åŠ¨æ€æˆªå›¾ï¼š

![](./pics/run.gif)

å‘½ä»¤æ‰§è¡Œç»“æŸåï¼Œåœ¨resultsæ–‡ä»¶å¤¹ä¸‹å¯æŸ¥çœ‹è¾“å‡ºçš„æŠ¥å‘Š(Fingeræ‰«æçš„ç»“æœåœ¨`tools/collect/finger/output`æ–‡ä»¶å¤¹å†…)

![Untitled](./pics/out.png)

## 0x03 é›†åˆ

ç›®å‰ä¸ºæ­¢ï¼Œå·¥å…·é›†åˆäº†å¸¸è§çš„åŸŸåæ”¶é›†ã€ç›®å½•æ‰«æã€ipæ‰«æã€æŒ‡çº¹æ‰«æã€PoCéªŒè¯ç­‰å¸¸ç”¨å·¥å…·ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

åŸŸåæ”¶é›†ï¼š

- subfinder:[subfinder(github.com)](https://github.com/projectdiscovery/subfinder)
- ksubdomain:[knownsec/ksubdomain: æ— çŠ¶æ€å­åŸŸåçˆ†ç ´å·¥å…· (github.com)](https://github.com/knownsec/ksubdomain)

æŒ‡çº¹æ‰«æï¼š

- Finger:[EASY233/Finger: ä¸€æ¬¾çº¢é˜Ÿåœ¨å¤§é‡çš„èµ„äº§ä¸­å­˜æ´»æ¢æµ‹ä¸é‡ç‚¹æ”»å‡»ç³»ç»ŸæŒ‡çº¹æ¢æµ‹å·¥å…· (github.com)](https://github.com/EASY233/Finger)

ipæ‰«æï¼š

- smap:[s0md3v/Smap: a drop-in replacement for Nmap powered by shodan.io (github.com)](https://github.com/s0md3v/Smap)
- fscan:[shadow1ng/fscan: ä¸€æ¬¾å†…ç½‘ç»¼åˆæ‰«æå·¥å…·ï¼Œæ–¹ä¾¿ä¸€é”®è‡ªåŠ¨åŒ–ã€å…¨æ–¹ä½æ¼æ‰«æ‰«æã€‚ (github.com)](https://github.com/shadow1ng/fscan)
- goon: [(github.com)](https://github.com/i11us0ry/goon)

ç›®å½•æ‰«æï¼š

- dirsearch:[maurosoria/dirsearch: Web path scanner (github.com)](https://github.com/maurosoria/dirsearch)
- ffuf:[ffuf/ffuf: Fast web fuzzer written in Go (github.com)](https://github.com/ffuf/ffuf)

PoCæ‰«æï¼š

- afrog:[zan8in/afrog: ä¸€ä¸ªæŒ–æ´å·¥å…· - A tool for finding vulnerabilities (github.com)](https://github.com/zan8in/afrog)
- autoxray:å†…ç½®ï¼Œxray basicçˆ¬è™«æ¨¡å¼è‡ªåŠ¨æ‰¹é‡æ‰«æ
- nuclei:[projectdiscovery/nuclei: Fast and customizable vulnerability scanner based on simple YAML based DSL. (github.com)](https://github.com/projectdiscovery/nuclei)
- pocsearch:å†…ç½®ï¼Œæœç´¢CVEç¼–å·æ¼æ´çš„poc/expåœ¨Githubçš„åœ°å€
- rad:[chaitin/rad (github.com)](https://github.com/chaitin/rad)
- vulmap:[zhzyker/vulmap: Vulmap æ˜¯ä¸€æ¬¾ web æ¼æ´æ‰«æå’ŒéªŒè¯å·¥å…·, å¯å¯¹ webapps è¿›è¡Œæ¼æ´æ‰«æ, å¹¶ä¸”å…·å¤‡æ¼æ´éªŒè¯åŠŸèƒ½ (github.com)](https://github.com/zhzyker/vulmap)
- xrad:å†…ç½®ï¼Œxrayå’Œradè”åŠ¨æ‰«æ

ä¸­é—´ä»¶æ£€æµ‹åˆ©ç”¨ï¼š

- Shiro: https://github.com/j1anFen/shiro_attack
- Struts2
- ThinkPHP
- Weblogic:https://github.com/21superman/weblogic_exploit
- é€šè¾¾OA

socks5ä»£ç†ï¼š

- RotateProxyï¼š[akkuman/rotateproxy: åˆ©ç”¨fofaæœç´¢socks5å¼€æ”¾ä»£ç†è¿›è¡Œä»£ç†æ± è½®åˆ‡çš„å·¥å…· (github.com)](https://github.com/akkuman/rotateproxy)

å…¶ä»–å·¥å…·ï¼š

- AppInfoScannerï¼šhttps://github.com/kelvinBen/AppInfoScanner
- frida-skeletonï¼šhttps://github.com/Margular/frida-skeleton
- Packer-Fuzzerï¼šhttps://github.com/rtcatc/Packer-Fuzzer

## 0x04 å®šä½

å¦‚å‰è¨€ä¸­æ‰€è¯´ï¼Œæ­¤æ¡†æ¶ä»…ä»…æ˜¯æŠŠæ¸—é€çš„å¸¸ç”¨å·¥å…·é›†æˆè¿›æ¥ï¼Œä½œä¸ºä¸€ä¸ªå¿«é€Ÿå¯åŠ¨ï¼Œå¹¶å°†è¾“å‡ºç»Ÿä¸€åˆ°åŒä¸€é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–¹ä¾¿å®‰å…¨æµ‹è¯•äººå‘˜å¿«é€Ÿé«˜æ•ˆå±•å¼€æ¸—é€æµ‹è¯•ã€‚æ‰€ä»¥å®šä½å°±æ˜¯æ¸—é€ç›’å­ï¼Œè¾…åŠ©å·¥å…·ã€‚ä½†é€šè¿‡å°†subfinderã€ksubdomainã€fingeræ•´åˆï¼Œé€šè¿‡ä¸€æ¡å‘½ä»¤ä¹Ÿå¯åšåˆ°èµ„äº§æ”¶é›†éªŒè¯æŒ‡çº¹æ‰«æï¼Œç»“åˆPoCæ‰«æéªŒè¯ä¹Ÿå¯è¿›è¡Œæ‰¹é‡åˆ·æ´ã€‚

## 0x05 å®‰è£…

#### æ‹‰å–é¡¹ç›®

ä¾èµ–äºPy3.6ä»¥ä¸Šç‰ˆæœ¬

```markdown
git clone https://github.com/givemefivw/SecurityServiceBox.git

cd SecurityServiceBox

pip install -r requirements.txt

python main.py
```

#### ä¸‹è½½å·¥å…·

è€ƒè™‘åˆ°å®‰å…¨æ€§ï¼Œé¡¹ç›®é‡Œé¢æœªå­˜æ”¾toolsï¼Œéœ€è‡ªè¡Œå°†å·¥å…·ä¸‹è½½è‡³æœ¬åœ°ï¼Œè‹¥æ˜¯ä¿¡å¾—è¿‡ï¼Œå¯ç›´æ¥åˆ°releasesé¡µé¢[Releases Â· givemefivw/SecurityServiceBox (github.com)](https://github.com/givemefivw/SecurityServiceBox/releases)ä¸‹è½½æ‰“åŒ…å¥½çš„toolså‹ç¼©åŒ…ï¼Œæ”¾å…¥é¡¹ç›®æ ¹ç›®å½•ä¸‹å³å¯

## 0x06 å¢åˆ æ”¹æŸ¥

å¾—ç›Šäºé˜¿æµªå¸ˆå‚…çš„æ¡†æ¶ï¼Œä»…éœ€å››æ­¥å³å¯è¿›è¡Œå·¥å…·çš„å¢åˆ æ”¹æŸ¥ï¼š

### Step 1 ä¸‹è½½æ‰€éœ€å·¥å…·

å°†å·¥å…·ä¸‹è½½è‡³é¡¹ç›®çš„`tools`æ–‡ä»¶å¤¹ä¸‹ï¼Œå¯æ ¹æ®å·¥å…·çš„åŠŸèƒ½è¿›è¡Œåˆ†ç±»ï¼Œä¾‹å¦‚ä»¥ä¸‹`pocScan`æ–‡ä»¶å¤¹ä¸‹å­˜æ”¾çš„æ˜¯nucleiã€vulmapç­‰pocæ‰«æå·¥å…·ï¼š

![Untitled](./pics/tools.png)

### Step 2 æ·»åŠ configå‚æ•°

ä¿®æ”¹`config/config.py`ä¸­ï¼Œå°†æ–°å¢çš„å·¥å…·çš„è·¯å¾„æ·»åŠ è¿›å»ï¼Œé™¤pythonç¯å¢ƒçš„ç»å¯¹è·¯å¾„ä¹‹å¤–ï¼Œå…¶ä½™å·¥å…·æ¨èä½¿ç”¨ç›¸å¯¹è·¯å¾„ï¼Œç”±äºæ˜¯Winç¯å¢ƒï¼Œåœ¨æ·»åŠ exeå·¥å…·æ—¶ï¼Œéœ€è¦ä½¿ç”¨`\\\\`ç¬¦å·é˜²æ­¢è½¬ä¹‰ï¼š

![Untitled](./pics/config.png)

### Step 3 æ³¨å†Œå‚æ•°

ä¾‹å¦‚æƒ³æ·»åŠ `pocscan_nuclei`æ‰«æï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€åœ¨`main.py`é‡Œé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š

```markdown
pocscan_nuclei_parser = Cmd2ArgumentParser()
    pocscan_nuclei_parser.add_argument("-u", nargs='?', help="æ‰«æå•ä¸ªç›®æ ‡")
    pocscan_nuclei_parser.add_argument("-f", nargs='?', help="æŒ‡å®šæ–‡æœ¬è¿›è¡Œæ‰¹é‡æ¼æ´æ‰«æ")
    pocscan_nuclei_parser.add_argument("-p", nargs='?', help="è®¾ç½®socksä»£ç†è¿›è¡Œæ‰¹é‡æ¼æ´æ‰«æ")

    @cmd2.with_argparser(pocscan_nuclei_parser)
```

æ­¤æ—¶å³å¯å®Œæˆå‚æ•°çš„æ³¨å†ŒåŠå¸®åŠ©ä¿¡æ¯ã€‚

### Step 4 æ·»åŠ å‘½ä»¤

`lib/cmd/wanli.py`æ–‡ä»¶ä¸­ï¼Œå®šä¹‰é¢„æœŸæ‰§è¡Œçš„å‘½ä»¤ï¼Œä¾‹å¦‚æ·»åŠ nucleiæ‰¹é‡æ‰«æï¼Œé€šè¿‡systemå‡½æ•°ï¼Œè°ƒç”¨configæ–‡ä»¶ä¸­å®šä¹‰çš„è·¯å¾„ä¸­çš„å·¥å…·ï¼Œæ‰§è¡Œæ‹¼æ¥å¥½çš„å®Œæ•´å‘½ä»¤ï¼Œå¢åŠ æˆ–ä¿®æ”¹å¦‚ä¸‹ä»£ç ï¼š

```markdown
@staticmethod
    def nuclei_file(file):
        system(config.config.pocscan_nuclei + " -ut && " + config.config.pocscan_nuclei + " -update")
        system(r"start cmd /k " + config.config.pocscan_nuclei + r" -l " + file +
               " -s medium,high,critical -rate-limit 100 -bulk-size 25 "
               "-concurrency 25 -stats -si 300 -retries 3")
```

æ­¤æ—¶å°±å®Œæˆäº†ä¸€ä¸ªå·¥å…·æ‰§è¡Œçš„æ·»åŠ ï¼Œåœ¨è¿è¡Œ`main`å‡½æ•°ä¹‹åï¼Œåªéœ€æ‰§è¡Œ`pocscan_nuclei -f url.txt`å‘½ä»¤ï¼Œæ§åˆ¶å°å°±ä¼šè‡ªåŠ¨çš„æ‰§è¡Œå®Œæ•´çš„è¾ƒé•¿çš„å‘½ä»¤ï¼Œä¸éœ€è¦æ¯æ¬¡éƒ½è¿›å…¥nucleiçš„æ–‡ä»¶å¤¹ç„¶åæ‰‹åŠ¨è¾“å…¥è¾ƒé•¿çš„å‘½ä»¤ã€‚
